<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>LMS XII - Predict</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=League+Gothic&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#ffffff; --text:#111;
  --gold:#D4A031; --accent:#ff8a2b; --max-w:980px;
  --p1:#0047FF; --p2:#D4112E; --p3:#00B063; --p4:#6A00FF;
  --p5:#FF7A00; --p6:#00D6FF; --p7:#FF2EC7; --p8:#FFD800;
  --panel-w:860px; --panel-h:420px;
}
*{box-sizing:border-box}
body{ margin:0; font-family:"League Gothic", Arial, sans-serif; background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased; display:flex; justify-content:center;}
.container{ width:100%; max-width:var(--max-w); padding:18px; }
.nav{ display:flex; justify-content:center; gap:28px; padding:12px 0; }
.nav a{ font-weight:700; font-size:22px; text-transform:uppercase; font-style:italic; color:#000; text-decoration:none;}
.nav a.current{ color:var(--accent); }

h1.title{
  font-family:"Bebas Neue", sans-serif; font-weight:400;
  font-size:clamp(100px,12vw,160px); margin:40px 0 10px; text-align:center;
  padding:20px; border:6px solid; border-radius:10px;
  border-image: linear-gradient(90deg,var(--accent),#00f2ff,#ffd400) 1;
  box-shadow: inset 0 -8px 18px rgba(0,0,0,0.06);
}
.tagline{ font-size:clamp(26px,5vw,36px); text-transform:uppercase; font-weight:700; color:var(--accent); text-align:center; margin-bottom:20px; }

/* top pick controls */
.top-questions{ background:#fff; padding:14px; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,0.06); margin-bottom:14px; border:3px solid rgba(0,0,0,0.03);}
.row{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
.col{ flex:1; min-width:180px; }
.label{ display:block; font-weight:900; font-size:13px; margin-bottom:6px; text-transform:uppercase; }
.select, .input, .button{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid #ddd; font-size:15px; }
.button{ background:#000; color:#fff; border:none; font-weight:900; text-transform:uppercase; padding:11px; cursor:pointer; }

/* player buttons */
#playerButtons{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin:12px 0 10px; }
#playerButtons button{ border:none; padding:10px 14px; border-radius:8px; font-weight:900; color:#fff; cursor:pointer; text-transform:uppercase; font-style:italic; box-shadow:0 6px 18px rgba(0,0,0,0.08); }

/* carousel */
.carousel-viewport{ width:100%; overflow:hidden; border-radius:12px; border:3px solid rgba(0,0,0,0.03); background:#fff; box-shadow:0 12px 36px rgba(0,0,0,0.06); padding:12px; }
.carousel{ display:flex; gap:16px; transition: transform 420ms cubic-bezier(.22,.9,.35,1); will-change: transform; align-items:start; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; padding-bottom:8px; }
.player-panel{ flex:0 0 var(--panel-w); width:var(--panel-w); height:var(--panel-h); display:grid; grid-template-columns:220px 1fr; gap:12px; align-items:start; background:#fff; border-radius:10px; padding:12px; scroll-snap-align:start; border:6px solid rgba(0,0,0,0.03); box-shadow:0 8px 26px rgba(0,0,0,0.06); }

/* sticker frame + portrait placeholder */
.sticker-frame{ width:200px; height:300px; border:6px solid var(--gold); border-radius:6px; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#fff,#fff); box-shadow:0 8px 18px rgba(0,0,0,0.06); }
.sticker-portrait{ width:180px; height:260px; border-radius:4px; font-weight:900; text-transform:uppercase; display:flex; align-items:center; justify-content:center; color:#fff; }

/* sticker info */
.sticker-info{ margin-top:10px; padding:8px; border-radius:6px; border:2px solid rgba(0,0,0,0.04); background:#fff; font-weight:900; text-transform:uppercase; font-size:13px; }

/* fixtures / lists */
.fixtures{ display:flex; flex-wrap:wrap; gap:8px; margin-bottom:10px; }
.team-box{ padding:8px 12px; border-radius:8px; font-weight:900; text-transform:uppercase; min-width:110px; display:inline-flex; align-items:center; justify-content:center; color:#fff; }
.picked-list{ margin-top:6px; padding:8px; border-radius:8px; border:1px dashed #eee; background:#fafafa; min-height:44px; font-weight:700; }
.points-grid table{ width:100%; border-collapse:collapse; margin-top:8px; }
.points-grid th, .points-grid td{ padding:6px 8px; border-bottom:1px solid #eee; text-align:center; font-size:13px; }
.points-grid th{ font-weight:900; text-transform:uppercase; font-size:12px; }

/* responsive */
@media(max-width:980px){
  :root{ --panel-w:760px; --panel-h:520px; }
}
@media(max-width:680px){
  :root{ --panel-w:320px; --panel-h:520px; }
  .player-panel{ grid-template-columns:1fr; width:var(--panel-w); height:auto; }
  .sticker-frame{ width:160px; height:210px; margin:0 auto; }
  .sticker-portrait{ width:140px; height:180px; }
}
</style>
</head>
<body>
  <div class="container">
    <nav class="nav" aria-label="Main navigation">
      <a href="index.html">Home</a>
      <a href="predict.html" class="current">Predict</a>
      <a href="table.html">Table</a>
      <a href="rules.html">Rules</a>
    </nav>

    <header>
      <h1 class="title">LMS XII</h1>
      <div class="tagline">CHOOSE <s>LIFE</s> HARV</div>
    </header>

    <main>
      <section class="top-questions" aria-labelledby="picklabel">
        <div class="row" style="margin-bottom:8px;">
          <div class="col">
            <label class="label" id="picklabel">Your name</label>
            <select id="top-name" class="select" aria-label="Your name">
              <option value="">-- Choose name --</option>
              <option>BILLY</option><option>CROSBO</option><option>INGZ</option><option>KABZ</option>
              <option>KIT</option><option>LOCKY</option><option>STOOBZ</option><option>T-CITY</option>
            </select>
          </div>
          <div class="col">
            <label class="label">Team for the week</label>
            <select id="top-team" class="select" aria-label="Team">
              <option value="">-- Choose team --</option>
              <option>Arsenal</option><option>Aston Villa</option><option>Bournemouth</option><option>Brentford</option>
              <option>Brighton</option><option>Burnley</option><option>Chelsea</option><option>Palace</option>
              <option>Everton</option><option>Fulham</option><option>Leeds</option><option>Liverpool</option>
              <option>Man City</option><option>Man Utd</option><option>Newcastle</option><option>Forest</option>
              <option>Sunderland</option><option>Spurs</option><option>West Ham</option><option>Wolves</option>
            </select>
          </div>
          <div class="col">
            <label class="label">Player pick</label>
            <input id="top-player" class="input" placeholder="Enter player name (eg Haaland)">
          </div>
        </div>
        <div class="row">
          <button id="submitPick" class="button">Submit pick</button>
        </div>
      </section>

      <div id="playerButtons" aria-hidden="false"></div>

      <div class="carousel-viewport" aria-label="Player carousel">
        <div class="carousel" id="carousel" role="list"></div>
      </div>
    </main>
  </div>

<script>
/* Persist picks to localStorage and build carousel panels (keeps behaviour as requested) */
document.addEventListener('DOMContentLoaded', ()=> {
  const PLAYERS = [
    { id:'BILLY', color:getComputedStyle(document.documentElement).getPropertyValue('--p1') || '#0047FF' },
    { id:'CROSBO', color:getComputedStyle(document.documentElement).getPropertyValue('--p2') || '#D4112E' },
    { id:'INGZ', color:getComputedStyle(document.documentElement).getPropertyValue('--p3') || '#00B063' },
    { id:'KABZ', color:getComputedStyle(document.documentElement).getPropertyValue('--p4') || '#6A00FF' },
    { id:'KIT', color:getComputedStyle(document.documentElement).getPropertyValue('--p5') || '#FF7A00' },
    { id:'LOCKY', color:getComputedStyle(document.documentElement).getPropertyValue('--p6') || '#00D6FF' },
    { id:'STOOBZ', color:getComputedStyle(document.documentElement).getPropertyValue('--p7') || '#FF2EC7' },
    { id:'T-CITY', color:getComputedStyle(document.documentElement).getPropertyValue('--p8') || '#FFD800' }
  ];

  const FIXTURES = [
    { home:'Man Utd', away:'Man City', time:'12:30' },
    { home:'Chelsea', away:'Brentford', time:'15:00' },
    { home:'Leeds', away:'Fulham', time:'15:00' },
    { home:'Liverpool', away:'Burnley', time:'15:00' },
    { home:'Sunderland', away:'Palace', time:'15:00' },
    { home:'Tottenham', away:'West Ham', time:'15:00' },
    { home:'Forest', away:'Arsenal', time:'17:30' },
    { home:'Wolves', away:'Newcastle', time:'14:00' },
    { home:'Aston Villa', away:'Everton', time:'16:30' },
    { home:'Brighton', away:'Bournemouth', time:'20:00' }
  ];

  const carousel = document.getElementById('carousel');
  const playerButtons = document.getElementById('playerButtons');

  // load saved picks (object of arrays)
  const savedPicks = JSON.parse(localStorage.getItem('lms_picks') || '{}');
  // load totals (if later used)
  const savedTotals = JSON.parse(localStorage.getItem('lms_totals') || '{}');

  PLAYERS.forEach((p, idx)=> {
    // create nav button
    const btn = document.createElement('button');
    btn.textContent = p.id;
    btn.style.background = p.color.trim();
    btn.setAttribute('data-player', p.id);
    playerButtons.appendChild(btn);

    // create panel
    const panel = document.createElement('div');
    panel.className = 'player-panel';
    panel.id = 'panel-'+p.id;

    const left = document.createElement('div');
    left.innerHTML = `<div class="sticker-frame"><div class="sticker-portrait" style="background:${p.color.trim()};">${p.id} PORTRAIT</div></div>
      <div class="sticker-info" style="border-color:${p.color.trim()};">
        <div style="font-size:12px;">Team (week): <span id="${p.id}-team">—</span></div>
        <div style="font-size:12px;margin-top:6px;">Player (week): <span id="${p.id}-player">—</span></div>
        <div style="font-size:12px;margin-top:6px;">Total: <strong id="${p.id}-total">${savedTotals[p.id] ? savedTotals[p.id] : 0}</strong></div>
      </div>`;

    const right = document.createElement('div');
    right.innerHTML = `<div class="fixtures" id="${p.id}-fixtures"></div>
      <div class="picked-list" id="${p.id}-pickedList"><strong>PICKED PLAYERS</strong><div id="${p.id}-pickedListInner"></div></div>
      <div class="points-grid"><table><thead><tr><th>Week</th><th>Team</th><th>Team pts</th><th>Player</th><th>Player pts</th><th>Week total</th></tr></thead><tbody id="${p.id}-tbody"></tbody></table></div>`;

    panel.appendChild(left);
    panel.appendChild(right);
    carousel.appendChild(panel);

    // populate fixtures styled in player colour
    const fxWrap = panel.querySelector(`#${p.id}-fixtures`);
    FIXTURES.forEach(f=>{
      const home = document.createElement('div'); home.className='team-box'; home.textContent=f.home; home.style.background = p.color.trim();
      const vs = document.createElement('div'); vs.style.alignSelf='center'; vs.style.padding='0 6px'; vs.style.color='#666'; vs.style.fontWeight='900'; vs.textContent='v';
      const away = document.createElement('div'); away.className='team-box'; away.textContent=f.away; away.style.background = p.color.trim();
      fxWrap.appendChild(home); fxWrap.appendChild(vs); fxWrap.appendChild(away);
      const spacer = document.createElement('div'); spacer.style.flexBasis='100%'; spacer.style.height='6px'; fxWrap.appendChild(spacer);
    });

    // populate weeks rows (17)
    const tbody = panel.querySelector(`#${p.id}-tbody`);
    for(let w=1; w<=17; w++){
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${w}</td><td class="team">—</td><td>—</td><td>—</td><td>—</td><td>—</td>`;
      tbody.appendChild(tr);
    }

    // fill picked-list from saved picks
    const inner = panel.querySelector(`#${p.id}-pickedListInner`);
    inner.innerHTML = '';
    if(savedPicks[p.id] && savedPicks[p.id].length){
      savedPicks[p.id].forEach(pk=>{
        const div = document.createElement('div');
        div.style.padding='6px 0';
        div.textContent = `${pk.week ? 'Wk '+pk.week+' · ' : ''}${pk.team} · ${pk.player} · pts: ${pk.pts ?? '—'}`;
        inner.appendChild(div);
      });
    } else {
      inner.innerHTML = '<em>No players picked yet</em>';
    }

    // button scroll behaviour
    btn.addEventListener('click', ()=> {
      const panelLeft = panel.offsetLeft;
      carousel.scrollTo({ left: panelLeft - 8, behavior: 'smooth' });
      document.querySelectorAll('#playerButtons button').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
    });
  }); // end players loop

  // keep nav highlight while scrolling
  const navButtons = Array.from(document.querySelectorAll('#playerButtons button'));
  const panels = Array.from(document.querySelectorAll('.player-panel'));
  function onScroll(){
    const scrollLeft = carousel.scrollLeft;
    let closest = 0; let min = Infinity;
    panels.forEach((p, i)=>{
      const d = Math.abs(p.offsetLeft - scrollLeft);
      if(d < min){ min = d; closest = i; }
    });
    navButtons.forEach(b=>b.classList.remove('active'));
    if(navButtons[closest]) navButtons[closest].classList.add('active');
  }
  carousel.addEventListener('scroll', throttle(onScroll, 100));

  function throttle(fn, wait){ let last=0; return function(...a){ const now=Date.now(); if(now-last>wait){ last=now; fn(...a); last=now; } } }

  // Submit pick -> saves to localStorage per-player and updates UI
  document.getElementById('submitPick').addEventListener('click', ()=>{
    const name = document.getElementById('top-name').value;
    const team = document.getElementById('top-team').value;
    const player = document.getElementById('top-player').value.trim();
    if(!name || !team || !player){ alert('Please select name, team and player.'); return; }

    const week = prompt('Enter gameweek number (optional):','');
    const ptsInput = prompt('If you already want to add player pts (total for this pick), enter a number or leave blank:','');
    const pts = ptsInput ? parseInt(ptsInput,10) : null;

    // load current picks
    const all = JSON.parse(localStorage.getItem('lms_picks') || '{}');
    if(!all[name]) all[name]=[];
    all[name].push({ week: week ? week : null, team, player, pts });
    localStorage.setItem('lms_picks', JSON.stringify(all));

    // update picked list UI
    const inner = document.getElementById(`${name}-pickedListInner`);
    if(inner){
      if(inner.querySelector('em')) inner.innerHTML = '';
      const div = document.createElement('div'); div.style.padding='6px 0';
      div.textContent = `${week ? 'Wk '+week+' · ' : ''}${team} · ${player} · pts: ${pts ?? '—'}`;
      inner.appendChild(div);
    }

    // optionally update totals if pts provided
    if(pts){
      const totals = JSON.parse(localStorage.getItem('lms_totals') || '{}');
      totals[name] = (totals[name] || 0) + pts;
      localStorage.setItem('lms_totals', JSON.stringify(totals));
      // update display
      const totalSpan = document.getElementById(`${name}-total`);
      if(totalSpan) totalSpan.textContent = totals[name];
      // broadcast event so table page (if open in another tab) could listen — we can't force-refresh other tabs here
    }

    alert('Pick saved (visual demo).');
  });

}); // DOMContentLoaded
</script>
</body>
</html>
